{"ast":null,"code":"var _jsxFileName = \"/Users/gabbybanaag/Desktop/momentum/src/components/login/Login.js\";\nimport React, { useState, useContext, useEffect } from 'react';\nimport { Paper, Avatar, Typography, TextField, FormControlLabel, Button, Grid, Checkbox } from '@material-ui/core';\nimport { useTheme } from '@material-ui/core/styles';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { BACKEND_URL } from '../../constants/urls';\nimport { makeAuthorizedRequest, setCreds } from '../../utilities/MomentumRequests';\nimport { useHistory } from 'react-router-dom'; // import { connect } from 'react-redux'\n\nimport UserContext from '../../utilities/UserContext';\nconst LOGIN_STATE_NONE = 0,\n      LOGIN_WAITING = 1,\n      LOGIN_FAILED = 2;\nexport default function Login() {\n  const history = useHistory();\n  const [signInInfo, setSignInInfo] = useState({});\n  const [loginState, setLoginState] = useState(LOGIN_STATE_NONE);\n  const [errorText, setErrorText] = useState('');\n  const [userInfo, setUserInfo] = useContext(UserContext);\n  const [remember, setRemember] = useState(false);\n  useEffect(() => {\n    sessionStorage.setItem('userState', userInfo);\n  }, [userInfo]);\n  const theme = useTheme();\n\n  const mapStateToProps = state => {\n    console.log('State :' + state);\n  }; // connect(mapStateToProps)(a => console.log(a));\n\n\n  const handleFieldChange = e => {\n    let tempInfo = signInInfo;\n    tempInfo[e.target.name] = e.target.value;\n    setSignInInfo(tempInfo);\n  };\n\n  const handleSignInWithRemember = () => {\n    setLoginState(LOGIN_WAITING);\n\n    if (signInInfo.username && signInInfo.username.length >= 8 && signInInfo.username.length < 40 && signInInfo.password && signInInfo.password.length >= 8 && signInInfo.password.length < 32) {\n      axios.post(BACKEND_URL + '/login', { ...signInInfo,\n        rememberme: true\n      }, {\n        withCredentials: true\n      }).then(res => {\n        if (res && res.data) {\n          setUserInfo({\n            loggedIn: true,\n            user: {\n              username: res.data.username\n            }\n          });\n          history.push('/');\n        } else {\n          setLoginState(LOGIN_FAILED);\n          setErrorText('Login failed due to server error. Try again later.');\n        }\n      }).catch(err => {\n        if (err.response && err.response.status === 401) {\n          setLoginState(LOGIN_FAILED);\n          setErrorText('Incorrect username or password.');\n        }\n      });\n    } else {\n      setLoginState(LOGIN_FAILED);\n      setErrorText('Username or password too short.');\n    }\n  };\n\n  const handleSignInNoRemember = () => {\n    setLoginState(LOGIN_WAITING);\n\n    if (signInInfo.username && signInInfo.username.length >= 8 && signInInfo.username.length < 40 && signInInfo.password && signInInfo.password.length >= 8 && signInInfo.password.length < 32) {\n      axios.post(BACKEND_URL + '/login', signInInfo, {\n        withCredentials: true\n      }).then(res => {\n        if (res && res.data) {\n          setCreds(res.data.creds);\n          setUserInfo({\n            loggedIn: true,\n            user: {\n              username: res.data.username\n            }\n          });\n          history.push('/');\n        } else {\n          setLoginState(LOGIN_FAILED);\n          setErrorText('Login failed due to server error. Try again later.');\n        }\n      }).catch(err => {\n        if (err.response && err.response.status === 401 || err.response.status === 400) {\n          setLoginState(LOGIN_FAILED);\n          setErrorText('Incorrect username or password.');\n        }\n      });\n    } else {\n      setLoginState(LOGIN_FAILED);\n      setErrorText('Username or password too short.');\n    }\n  };\n\n  const handleRememberChange = e => {\n    setRemember(e.target.checked);\n  };\n\n  return /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      marginTop: '15vh'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: 10,\n    md: 5,\n    lg: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Paper, {\n    style: {\n      padding: '2.5em',\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    },\n    elevation: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    src: \"logo.svg\",\n    style: {\n      height: theme.spacing(12),\n      width: theme.spacing(12)\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Typography, {\n    component: \"h1\",\n    variant: \"h5\",\n    style: {\n      marginTop: '1em'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, \"Member Login\"), /*#__PURE__*/React.createElement(\"form\", {\n    noValidate: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    label: \"Username\",\n    name: \"username\",\n    autoComplete: \"momentum_user\",\n    autoFocus: true,\n    onChange: handleFieldChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    name: \"password\",\n    label: \"Password\",\n    type: \"password\",\n    id: \"password\",\n    autoComplete: \"current-password\",\n    onChange: handleFieldChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      value: \"remember\",\n      color: \"primary\",\n      checked: remember,\n      onChange: handleRememberChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 30\n      }\n    }),\n    label: \"Remember me\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    fullWidth: true,\n    variant: \"contained\",\n    color: \"primary\",\n    style: {\n      marginTop: '1em'\n    },\n    onClick: remember ? handleSignInWithRemember : handleSignInNoRemember,\n    disabled: loginState === LOGIN_WAITING,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }\n  }, \"Sign In\"), loginState == LOGIN_FAILED ? /*#__PURE__*/React.createElement(Typography, {\n    style: {\n      color: '#FF0000'\n    },\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 49\n    }\n  }, \" \", errorText, \" \") : '', /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    style: {\n      marginTop: '1em'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    href: \"#\",\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 21\n    }\n  }, \"Forgot password?\")), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    xs: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/register\",\n    style: {\n      textAlign: 'right',\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 90\n    }\n  }, \"Have an access code?\"))))))));\n}","map":{"version":3,"sources":["/Users/gabbybanaag/Desktop/momentum/src/components/login/Login.js"],"names":["React","useState","useContext","useEffect","Paper","Avatar","Typography","TextField","FormControlLabel","Button","Grid","Checkbox","useTheme","Link","axios","BACKEND_URL","makeAuthorizedRequest","setCreds","useHistory","UserContext","LOGIN_STATE_NONE","LOGIN_WAITING","LOGIN_FAILED","Login","history","signInInfo","setSignInInfo","loginState","setLoginState","errorText","setErrorText","userInfo","setUserInfo","remember","setRemember","sessionStorage","setItem","theme","mapStateToProps","state","console","log","handleFieldChange","e","tempInfo","target","name","value","handleSignInWithRemember","username","length","password","post","rememberme","withCredentials","then","res","data","loggedIn","user","push","catch","err","response","status","handleSignInNoRemember","creds","handleRememberChange","checked","display","justifyContent","marginTop","padding","flexDirection","alignItems","height","spacing","width","color","textAlign"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\nimport { Paper, Avatar, Typography, TextField, FormControlLabel, Button, Grid, Checkbox } from '@material-ui/core'\nimport { useTheme } from '@material-ui/core/styles'\nimport { Link } from 'react-router-dom'\nimport axios from 'axios'\nimport { BACKEND_URL } from '../../constants/urls'\nimport { makeAuthorizedRequest, setCreds } from '../../utilities/MomentumRequests'\nimport { useHistory } from 'react-router-dom'\n// import { connect } from 'react-redux'\nimport UserContext from '../../utilities/UserContext'\n\nconst LOGIN_STATE_NONE = 0, LOGIN_WAITING = 1, LOGIN_FAILED = 2;\n\n\n\nexport default function Login() {\n    const history = useHistory();\n    const [signInInfo, setSignInInfo] = useState({});\n    const [loginState, setLoginState] = useState(LOGIN_STATE_NONE);\n    const [errorText, setErrorText] = useState('');\n    const [userInfo, setUserInfo] = useContext(UserContext);\n    const [remember, setRemember] = useState(false);\n\n\n    useEffect(() => {\n        sessionStorage.setItem('userState', userInfo);\n    }, [userInfo])\n\n    const theme = useTheme();\n\n    const mapStateToProps = (state) => {\n        console.log('State :' + state);\n    }\n\n    // connect(mapStateToProps)(a => console.log(a));\n\n    const handleFieldChange = (e) => {\n        let tempInfo = signInInfo;\n        tempInfo[e.target.name] = e.target.value;\n        setSignInInfo(tempInfo);\n    }\n\n    const handleSignInWithRemember = () => {\n        setLoginState(LOGIN_WAITING)\n        if (signInInfo.username && signInInfo.username.length >= 8 && signInInfo.username.length < 40 && signInInfo.password && signInInfo.password.length >= 8 && signInInfo.password.length < 32) {\n            axios.post(BACKEND_URL + '/login', {...signInInfo, rememberme: true}, {withCredentials: true})\n            .then((res)=>{\n                if (res && res.data) {\n                    setUserInfo({loggedIn: true, user: {username: res.data.username}});\n                    history.push('/')\n                } else {\n                    setLoginState(LOGIN_FAILED);\n                    setErrorText('Login failed due to server error. Try again later.')\n                }\n\n            })\n            .catch((err)=>{\n                if (err.response && err.response.status === 401) {\n                    setLoginState(LOGIN_FAILED);\n                    setErrorText('Incorrect username or password.');\n                }\n            });\n        } else {\n            setLoginState(LOGIN_FAILED);\n            setErrorText('Username or password too short.');\n        }\n    }\n\n    const handleSignInNoRemember = () => {\n        setLoginState(LOGIN_WAITING)\n        if (signInInfo.username && signInInfo.username.length >= 8 && signInInfo.username.length < 40 && signInInfo.password && signInInfo.password.length >= 8 && signInInfo.password.length < 32) {\n            axios.post(BACKEND_URL + '/login', signInInfo, {withCredentials: true})\n            .then((res)=>{\n                if (res && res.data) {\n                    setCreds(res.data.creds);\n                    setUserInfo({loggedIn: true, user: {username: res.data.username}});\n                    history.push('/')\n                } else {\n                    setLoginState(LOGIN_FAILED);\n                    setErrorText('Login failed due to server error. Try again later.')\n                }\n\n            })\n            .catch((err)=>{\n                if (err.response && err.response.status === 401 || err.response.status === 400) {\n                    setLoginState(LOGIN_FAILED);\n                    setErrorText('Incorrect username or password.');\n                }\n            });\n        } else {\n            setLoginState(LOGIN_FAILED);\n            setErrorText('Username or password too short.');\n        }\n    }\n\n    const handleRememberChange = (e) => {\n        setRemember(e.target.checked);\n    }\n\n    return (\n    <Grid container style={{display: 'flex', justifyContent: 'center', marginTop: '15vh'}}>\n        <Grid item xs={10} md={5} lg={4}>\n            <Paper style={{padding: '2.5em', display: 'flex', flexDirection: 'column', alignItems: 'center'}} elevation={2}>\n                <Avatar src='logo.svg' style={{height: theme.spacing(12), width: theme.spacing(12)}}/>\n                <Typography component=\"h1\" variant=\"h5\" style={{marginTop: '1em'}}>\n                    Member Login\n                </Typography>\n                <form noValidate>\n                <TextField\n                    variant=\"outlined\"\n                    margin=\"normal\"\n                    required\n                    fullWidth\n                    label=\"Username\"\n                    name=\"username\"\n                    autoComplete=\"momentum_user\"\n                    autoFocus\n                    onChange={handleFieldChange}\n                />\n                <TextField\n                    variant=\"outlined\"\n                    margin=\"normal\"\n                    required\n                    fullWidth\n                    name=\"password\"\n                    label=\"Password\"\n                    type=\"password\"\n                    id=\"password\"\n                    autoComplete=\"current-password\"\n                    onChange={handleFieldChange}\n                />\n                <FormControlLabel\n                    control={<Checkbox value=\"remember\" color=\"primary\" checked={remember} onChange={handleRememberChange} />}\n                    label=\"Remember me\"\n                />\n                <Button\n                    fullWidth\n                    variant=\"contained\"\n                    color=\"primary\"\n                    style={{marginTop: '1em'}}\n                    onClick={remember ? handleSignInWithRemember : handleSignInNoRemember}\n                    disabled={(loginState === LOGIN_WAITING)}\n                >\n                    Sign In\n                </Button>\n                {(loginState == LOGIN_FAILED) ? <Typography style={{color: '#FF0000'}} variant='body2'> {errorText} </Typography> : ''}\n                <Grid container style={{marginTop: '1em'}}>\n                    <Grid item xs>\n                    <Typography href=\"#\" variant=\"body2\">\n                        Forgot password?\n                    </Typography>\n                    </Grid>\n                    <Grid item xs>\n                        <Link to='/register' style={{textAlign: 'right', width: '100%'}}><Typography variant='body2'>Have an access code?</Typography></Link>\n                    </Grid>\n                </Grid>\n                </form>\n            </Paper>\n        </Grid>\n      </Grid>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}